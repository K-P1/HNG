# Stage 0 — Profile endpoint (FastAPI)

This project implements a small FastAPI application exposing a GET `/me` endpoint that returns profile information and a dynamic cat fact fetched from `https://catfact.ninja/fact`.

Key features

- GET `/me` returns JSON with the fields: `status`, `user` (email, name, stack), `timestamp` (UTC ISO8601), and `fact`
- External Cat Facts API integration with timeout and graceful fallback
- Modular code structure: `app/schemas.py`, `app/services.py`, `app/routes.py`, `app/main.py`
- Basic logging and optional Redis-backed lifespan and rate limiting
- Tests covering success and failure scenarios

Requirements

- Python 3.11+
- Install dependencies from `requirements.txt`

Setup (PowerShell)

1. Create a virtual environment and activate it:

```powershell
python -m venv .venv; .\.venv\Scripts\Activate.ps1
```

2. Install dependencies:

```powershell
pip install -r requirements.txt
```

Environment variables

- `CAT_FACTS_URL` — override the cat-fact service URL (default: `https://catfact.ninja/fact`)
- `CAT_FACTS_TIMEOUT` — timeout in seconds for external calls (default: `2.0`)
- `REDIS_URL` — Redis URL for rate limiting (default: `redis://localhost:6379/0`). Redis is optional; see note below.

Configuration using `.env`

- A sample `.env` file is included as `.env.example`. Copy it to `.env` and fill in your personal values for local development.
- This project uses `pydantic-settings`'s `BaseSettings` (via `app.config.Settings`) to load environment variables and support an `.env` file.

Example (PowerShell):

```powershell
Copy-Item .env.example .env
```

Run locally

Start the server with uvicorn (module path points to the FastAPI `app` object in `app/main.py`):

```powershell
uvicorn app.main:app --reload
```

The app will be available at: `http://127.0.0.1:8000/me`

Run tests

```powershell
pytest -q
```

Notes and design choices

- The timestamp in responses is generated by the Pydantic model default factory using UTC ISO8601.
- Redis (optional): If a running Redis instance is available and the `redis` package is installed, the app will attempt to connect and use Redis for rate-limiting and lifespan features. If Redis is unavailable or the `redis` package is missing, the application logs a warning and continues to run without Redis-backed features.
- `status` behavior: The `status` field in responses is always set to `"success"`. If the Cat Facts API fails, the endpoint returns a short fallback fact and `status: "success"`. This is an intentional design decision to keep the endpoint predictable for clients while providing dynamic content when available.
